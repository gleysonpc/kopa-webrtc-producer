(this["webpackJsonpkopa-webrtc-producer"]=this["webpackJsonpkopa-webrtc-producer"]||[]).push([[0],{249:function(e,n){},251:function(e,n){},264:function(e,n){},266:function(e,n){},294:function(e,n){},295:function(e,n){},300:function(e,n){},302:function(e,n){},309:function(e,n){},328:function(e,n){},387:function(e,n,t){"use strict";t.r(n);var r=t(1),c=t.n(r),i=t(202),o=t.n(i),a=t(62),s=t(4),u=t.n(s),d=t(19),l=t(13),b=t(16),p=t(2),f={signed:null,user:{name:"",room:""},signIn:null,signOut:null},j=Object(r.createContext)(f),x=function(e){var n=e.children,t=Object(r.useState)(null),c=Object(l.a)(t,2),i=c[0],o=c[1],a=Object(b.g)();function s(){return(s=Object(d.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.name,r=n.room,o({name:t,room:r}),localStorage.setItem("@user",JSON.stringify({name:t,room:r})),a.push("/");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=localStorage.getItem("@user"))&&(o(JSON.parse(n)),a.push("/"));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a]),Object(p.jsx)(j.Provider,{value:{signed:!!i,user:i,signIn:function(e){return s.apply(this,arguments)},signOut:function(){o(null),localStorage.removeItem("@user")}},children:n})};function v(){return Object(r.useContext)(j)}var h,m=t(44),g=function(e){var n=e.components,t=e.children;return Object(p.jsx)(r.Fragment,{children:n.reverse().reduce((function(e,n){var t=Array.isArray(n)?[n[0],n[1]]:[n,{}],r=Object(l.a)(t,2),c=r[0],i=r[1];return Object(p.jsx)(c,Object(m.a)(Object(m.a)({},i),{},{children:e}))}),t)})},O=t(81),k=t.n(O),w=t(82),y=t.n(w),z=Object(r.createContext)({socket:{},authenticateSocket:null,destroySocketConnection:null});function A(e){var n=e.children,t=Object(r.useState)({}),c=Object(l.a)(t,2),i=c[0],o=c[1];return Object(p.jsx)(z.Provider,{value:{socket:i,authenticateSocket:function(e,n){o(function(e,n){var t={name:e,room:n},r=y.a.sign(t,"oqksmz");return h||(h=k()("https://webrtc.dev.kopa.media/",{auth:{token:r},transport:["websocket","polling"],path:"/v6"}),window.testeSocket=h,h.request=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(t){h.emit(e,n,t)}))},h.on("connect",Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.request("joinRoom",{roomId:t.room});case 2:case"end":return e.stop()}}),e)})))),h)}(e,n))},destroySocketConnection:function(){(null===i||void 0===i?void 0:i.connected)&&i.disconnect()}},children:n})}var T,P,S,E,H,L=t(211),F=t(34),N=t(11),C=t(12),X=C.b.div(T||(T=Object(N.a)(["\n    display: flex;\n    align-items: center;\n    margin: 10px 0;\n    img {\n        width: 50px;\n        height: 50px;\n        margin-right: 10px;\n    }\n\n    .message-section {\n        h5 {\n            margin: 0 0 3px 0;\n        }\n\n        p {\n            margin: 0;\n            font-size: 14px;\n            color: #7e8291;\n        }\n    }\n"]))),R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfYAAAH2CAMAAAC1NV6OAAAAY1BMVEUAAADc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uzc5uynvcrM2uKctcOyxdHH1t68zdeXsL+MqLjR3uXB0du3ydTX4umswc2SrLyiucaHpLXc5uy18NxOAAAAEHRSTlMAQL/vEGCAnyDfMM+PcK9Q5BLY4gAAEylJREFUeF7s10tugzEIBGCMbWz8vAL3P2WVSlk3Tf+Hnc63Yz2CEfQPALgneejPKdNngfIdMTOr/YCZk0h0LtCmILgpjdneozyku0LbgDJlsB1DufXFGwDylFHtBI/waT1QYmM7lw5Zp/UhOGFvF6mpF7oZ5NiqXc2zOLoJhJjUbnNH9DBbtbv50TNdBXIftgptk84HpVVbix8x0IlgNrUl8VnnHmbytrB6fPJQkrfl1SOvPeSmtokR6QgQYrWd+FToj8Al24/2QG+D0NU2lRxdA4u+/8pDrLa937U8ZPH2EXjSi6Ak+xz60i8Pjr/YNYPcCGEYihYcCBAYVJUuqtn8+5+yi65GlVpER6qS/94Vnmx/O1FbxOggnpH+nfzT3RaGWZIQj3TEIx3xSK9dPHSzTMjnUj0rW5PrHEw3eREb0tMqP2b3k+0WsqRfSHKWrImhbgMjfgyZUzr6e/vQ6dNXf4fYLfM79JNLlOsFD9HOsdShLJalDiOlXj8UPKXOhB9C7UOkZ1dnh+9CdvD1ZtTvwNxWspuKTgEtJbs9dBK4NdPoV9lBo09FBtDoSfAk+u2CAChT3Q0+6woQHXtbVTDgl5AdDPhBfwFKctzWIRbCHG9yNjcaGOoKc7OeAmQi/D+Adz5PEehZ3PDOFZ6n2KxnA7FgHe9Yx3vTpzkYOM3hHet4xzresY53rOMd63ival+HHeuXeD2O97cHPo7jzt3mAvmTvTPabhMGgmgNJoYkTYSwECDLs///lX3pS3vSNLET2BF7f2HOSjPalST6Sedl8B7/Ins3zH1Bupvq6TxcMz6Ed6Hn1906rWm+jPgc8bqolr5ubariXabF4zaymynnLkz1aRlxD9HNZLrbtGQKI+4nul5U8mKqv0HvIr6IMSSbp/2bYyf6mD2+kniZ1L9Sa+2XkPHlOIXCNxbYbxCdX/hHu9P6mznj23CTymMbi25nj+8kDknEYtyjqCI5fDd5FlVUW9i5WjSxRKyAn0QTzzs38ZPHOsRh33b+xFnq9zNOFLau/K5b8liTuIgeulVt3UH0MEeszDWx2zp+O3fB+uR+l7auEi2kEZuwEA9V8p/O9REb4XY3bPMqWggRmzEmUcLTKqq3tShhwJbkflfb+5MowWFbYk+3vfP/7JWu2Jywm+39oNDCm+7VilNUpjoQ9jFj9WKq/0nYw6xNo1R10707rpjdTHUgFJ/iKr2qm+6Hwrutb6puutfHopd4B3X0Jd+QqnSrbud1r+Uu8QEayYlgmSd28WfoZCz1QmSlpL+uFFemm28sur3PUuKhzbFmsHNm5x8KPItf8D/M1j0W127toZtrcS3YjmVjt+39Z2ETNRdoJ/ZFhfe25knslt5PJfm5lEHAUFB4P9gS/1HiVI6r68zFfxgvCmiKacF4kDAX4uqONVvfzXpxD2Xcc0wRn8FcXXt3eCO87Gau7lRCeJsiiHAEIY4ivDlQUUCIqzQUO9bAyp2/2K3cn9jvsk9gw5Gf2TTWeaMt9468zR5Bx4W63BubpLqNmJjLvRMFZBASiMu9sfsQtzIKb7l33OnNpqcb2mJPuBnLcB1tsQdwEoW03Bv2Jwxs3EI60quOE1hxnOV+EP7Qbqt8RVns4kHLzHjzuZUSfLyt8i+MHz8F8JJF6KbqjoU8HW7PV50IXw/PIGbhe62uFotv93Kle3u6kUK2dotw0tH9C+JATS8qaNi+6B5BTSD7WeIkltoL+iqupUpvcgY3XnTwzPVb8wJyRAf1DY12ekdnnk4aqk+6PciZhcjUnUQJYGcQJbREf7MnsOOEx9Q1v9g7F93GVSAM575NnXZjLsY2xud//6c8u2pX8kqrOm2BDOT/HiCR9QkYBmZAZYE8Q3mcC3qSfyheeyjnaf8n8JnuaEAKPzIeuVK7hxQOhWzagbl87QYoY+v+DDEoas92p+5C7REZIIanpHM8j12XaIjhpZA5HjEFUHuTOTFL7fJn+XOt2qn9Jd8cT+1yaLLG8dQuf5Y/16ud2o/Z5nhqF8Rrznw8tYvPyzc1a6f2nxnPXKld+unrsWrt1L7P/j4Itct95HsPUThqj8wpy/14HryOEEWTJUVH7QayOGTavlG79C3cAcKYytfeAtK3cD8RHV6YFsZZ/tIOS+3RecqxtLMYShpH8Us7emqPzo8cSzsLncUv7heIo2O2Jvni3kAcitv25Dt3yEOz8jE6l9QJeRa4B8ijSV3fzFB+hkBS97Dg0auGQLaJz9oZ0xkI5CXxNTrGdB4CeU2brGF6toNEzmkjOubpJojkkDSi4+I+QCTbpBEdF3cPkZykR3RAy+O3lIdwWwgl8BwmNk3KiI4t5XsIZVkPI5SB27eEtTENpOI4x6e7WAWxXDnHJwvlnyGWlnN8bHbJUrOM5S3E0qQK5PkqmPOQy6L3pFg8X4lJFcrvIJgri98SZeX3EEzLxGyiUB6iUTx8i8slSUaemboA0eyK0I7A3VuKHdwJsrEc7HFJoZ3D3UI4h/j7N67uAdLZxtfOYH4oRPse0jHcs8ffuCMiTNWZQrQ/QT69YzY+cmXMFgWgefQWj11k7exoMqIU7S8oAcN4Lh5RszXsRep6ao+MD5ziY2p/RRm0nOJj5mt2KAT9iFE8tUM9YlaW2r1jG4NohTEoB8OCiGjZWRTEyIVdknaeybRIB7X7jsVPUbQfUBQ+sOFkjKT8FmXROp62StBO7zMeTzvrJTpP7TmwtB5HO73Lt07tsLR+R+303nlQexHeaR1NsdoxOFr/Mkvt3L/Lz9JQO9pA67m181zGgtrvg7/fOawzeDjtvHfRtSiYc+naYdxdlnWPBdy358erByyDoHZAVzPBU7s3xoz6F9YL28lNHmu0+jeDMYbab6Qd9KzcUsC1xwp+yiY9rJu04a+5QU2j8dT+gb1hWizUnxJvOilDffjn1BPmsaX2f9BOH5hzGmtoJ2FVb9UHHzHbXoz2ZwjAXN23J9c+de7G2e8vNt3Yy9C+wb3p9U0h2eyxglEppev1/7/tO6yIlx9xX8x882gbcMPCGpvb48qbPyRo/+BVMXaxoMcY8LDhPtIxuAg/WIX2+I7ciFWG2FO9m3pEGOoCxC+1n3EnzFcGpuqxShszuAujxyqjKyqxf0re1mB9q5NgwMOPIdLsPmCd/qufoh+tm4WfUufE26v7rvNu9ED0ob4kmIfSbkKOAtPhuvI3MXbYbRcj7Zdf+0VAa8Fko6TV6is/f7U+wvGf2AH/lLsd4XJ85BolRiv3KeVt+llriZbThVL+BfcwfPJcT60qUldtfKYAZYnyd9D+s9RLEbPHJ2nNqCel1N/DW6lZ62FFeNKUYGgzX6X7xbbYnkNuxP3ws+R7uOuNxZ8LvtmuetyJMfI5r82tfVN0PYP20nJN8r1fFtpLrWIJFinIf7JvM78M1RReu9QZ5MRrV3h11XHzm13xFWvKFCt9ic36/N+PCvqGqkGMdPlvyD0vnvbNbl3+Gp//tl6b8UXnYyU1ik73SMigKulTvX/Tvq2nheA8pLvmWU1blN2b9qeaGo6EqUd0hrmmFhmvmzcqazvRWR+3bsPV1STj9K69qa75/2x9LOehugcJju/adxX2kFual+98SfDJt+1vnCp9hbv7RrmhH66h0g5Yh3ftx3qfb3PXr5QbGq3qfVBuv3lnW/drTm7+xKWZ1k6q7lemdpt3DomneAkEpe3H8nujJ/UAz1FcNn/YP8wLnUpNb91FTA8A5jej1rMK/0nCIB0vm036UN7+z969JscJA0EAbiyEeG8SJ+tN/CD3P2V+pVRrA6t1MlVTTX93EPS0JFjEV5qv8Nfo7Les8mgf5IHo7SKEXAyDvHmUvyyfI9/sgnxml+fEWaprkA3efrwtZ9tG3vJc1XkRb1txPbLJ3fAmr79NANaZ7p8qEPllnegALfYVjNX8iAwYjrHY1dmckAHjMRa7lnuLDIiHWOwK8x2utIdY7ArzM66FI8zsWu4Trs0OCzo5m5Q1hoXN2+KQmnm803vcepM3m7ImC/z77Np3bwDTl/vT4pAqmwrvTfzTm2Y4fNC7PF4hP02m9iywBzqFugkfJZeBTp4tpvYsktfx2nYPyAxq+a+LR2rqEtYMLr9iIBeL05PZyD206ylfY01F/YzXU37AusCc41XQTliXmHO8snyPdVE5nrix6bChJvhoyRY1NiO2zLynqdTL94DhU/55EY+fLAvYVNPuuWr3NWHbbFDRiYsPkp6wLZKObxrhAnbUpFvtGuES9swexzd5Mn3GA5HyfLxe7h121ZS7b+pnR+xLjM2s+tke+06EU7te7h1uCXxTuyb3CbeMfFO7JvcWt/R0hbxq+Rm3DQ7/8iev/+HspNno/rj4oz33gAI12d03feBgRInEVdboxnOLEhXVPowKmweU6ZgSnTJdRJlIlOiU6QIK1YEn0SnTNSiVeBKdMl2LUi1NR6eeLqHcA8uXJ/WvqArlKn8HquTT11zLdRxXXbX3GnGPSBHkdSWqw30CQ5BXlG9wn4YgyCvK/2HnvpImhWEojF6QnEj95zB5/6ucR54B20hV92zhq+5CwlgUx6j4f5Dno3zEUdHagzy1W9XssvuNPLfyCcclbuS9b+UzjsvOr7Hg6dkEdPi5GwvACS7jjOz6aA0P2CSckzzPb5zgMs7Jtj5/oy4/diD5nd+YPeOsLF6/euQ7uITzotOxnYO7ZJyn4nNs5+AecUV0ObZzcBfFFVrsZKdfnX7sQHB4aw0H94KrZn/bGmYPuGpwl53fwY24bvS2reG+ZsB12Vl2Zk+oIVrJTl/NNzU7FU+XzXJNF1FHcLSbZfaCWkY/2Zl9QC2Tjez0fuDqwQoWJ19CcSkvGfVo8bGSZ/aImh4usjP7jLo2D9mZfUBdKvaz88j0gtpW8+9d+QquKKobrb+AY/YB9WWxnZ3ZF7Swms7O7EXRxGg5O7MPaCPLvdnpo+Nf/G69OTv1/IvfbVavkmf2Ae2o2Dxcw+wRLT1MZmf2GW0tBrMzu0xoS2d72Zk9oLVJrGVn9g3tBWPZmb0oOki2sjP7hB50tpSd2Vf0MYmd7My+oZdgJjuzz4pukpHszC4TOpptZGf2gJ5ULGRn9gV9TQayM/uI3sLtL16ZvSi6Szcfs+Dpmv/s3W2SoyAUheEjXEXBzoedaNIkmbv/VU7Nn7Fqqru6M0lE5TxbeAtBVLQeCZi02fku3RYpSEiZndnfkIa36T6GYnaHVHyy7MxukE6Z6IBpZg+ChKokh5gwu62RlEuQndmtR2Kb6bMze4HUJEydndlLpCdh2uzMXmIOxE6ZndlbzIO30505y+wOc+HtVE9emd1hPrydIjvd1GFOvD2/PAD10WBeigl+7cvqQTAzZV7dWX3sPuTTgNXH7vuXdaduptWB0r6qO+00CGbKv6w7qxsBcuvO6g7ArLv3zw5AF3WYN2/jk7vTUR3mzodnd2f1FvMnQXdPC0DDQUsgr+407LXEQrgnbdRSf7IFFsPpeXg8AHXReiSQeKOWW3M1FmX78I0cfagRLIy38ZGFHQ1ndVgeCQ+8aEXXvb5hieShhR0Xc1ssVKX/t0NPF208Fmtr4+3uADQc1QgWzN8/wVO/1xbLJhs93DXB0y7aEotXaex+HoA+NHisQHHXJzO8b3OCVRDzwws93eJ4t57PhZ4r+MZjRQqrH98EoP6kG8GqiPlm64be1ZZYnTfVy5cB6HrQUGOFfNDD9fMAdIlaYaVajV8MeA71psBqFc3nA55DvRWsmOQ24DnUxwGfy5KeQ30k7XisFfV7bQpkoQh6+rNpR8O7aivIRaV6HFj9dtLgkZHaaLxwKWcrZKa0uu8yv75vamRHWtVztjfxu5M2BbLkjep7llN8N17fc7RtNMNvZ65HVVcjY1JZPXXZTeqmQObEqR66jKJHbUoQaqPZPKDZxb+TOhVG9XjNYvluKwGND2jG8CuO/u/L0FSO4dcbvcanGL5fZ/Tf7ZjbspwgFEQDjjioeAF0EI3p///KUHqmKg+nkrk6aHbX+oNVu+niH9JJvNVHXO8k/a+kBWCbY33O+Nuk06p302G+bPsOtN5vgmXA6A+x7hoLSEXSb+NcJsAw773djQOKlHTezknJnXe97gBkjFTeSV0B6PQ+t/vkACke3nHU9c7s7pWfBwCc2v1xUg7ANjsq+947ICnp0J/jLCSAbt7HiptaAFVN2l4AyxJgjN78ZXFeKDr0l5FWiNv8z2kAIMucXL2UU8Tm125P3uiczGNootr22rvlzt/+oJP51us4zrwZRur2bagziZBh6j+74GbfIoTThtuKXHGEjEH9R5XLrD6RjU2py2JVb/TGxb4qTypF1f4RTl/q0fqm3+LItRlcHMpJveBYYn2j33fjV+OQGSmPhFxlBZa0g5n1i0988nZECBIuatpvkcFUxrHGWW+0fvrAGzNYrJFkPGbyWlQc19igf9L6co/tXmsTdDt8JeGlYrTX98CZKcE5/khrrTUhk/4uswnprF3K/IrkmagZCdgfLOgvOU9wRwrORdBNjX4EcsaYCCn5d6lESMrY/1LmvwE3sBhDPin7fQAAAABJRU5ErkJggg==";function I(e){var n=e.user,t=e.message;return Object(p.jsxs)(X,{children:[Object(p.jsx)("img",{src:R,alt:"user avatar"}),Object(p.jsxs)("div",{className:"message-section",children:[Object(p.jsx)("h5",{children:n}),Object(p.jsx)("p",{children:t})]})]})}var D=C.b.div(P||(P=Object(N.a)(["\n    background-color: #262837;\n    height: calc(98vh - 20px);\n    border-radius: 20px;\n    width: 28%;\n    min-width: 300px;\n    position: relative;    \n    overflow: hidden;\n    margin-top: 20px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    z-index: 11;\n\n    @media(max-width: 800px){\n        width: calc(100% - 40px);        \n        height: inherit;        \n        padding-bottom: 0;\n        margin: 0 20px 0 20px;\n    }\n\n"]))),q=C.b.div(S||(S=Object(N.a)(["\n    height: 70px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 20px;\n\n    p {\n        color: #7e8291;\n        svg {\n            margin-right: 5px;\n        }\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n"]))),J=C.b.div(E||(E=Object(N.a)(["\n    padding: 0 20px;\n    height: 100%;\n    display: flex;\n    flex-direction: column-reverse;\n    overflow-y: auto;       \n    align-content: flex-end;    \n"]))),U=C.b.form(H||(H=Object(N.a)(["    \n    bottom: 0;\n    height: 60px;\n    display: flex;\n    width: 100%;\n    padding: 8px;\n    background: #262737;\n    position: relative;\n\n    input {\n        width: 100%;\n        background-color: #2e303f;\n        border: none;\n        color: #fff;\n        outline: none;\n        border-radius: 20px;\n        padding: 0 45px 0 10px;\n        height: 45px;\n    }\n\n    button {\n        background-color: #6b5ecd;\n        border: none;\n        color: #fff;\n        outline: none;\n        border-radius: 50%;\n        position: absolute;\n        height: 38px;\n        width: 38px;\n        top: 12px;\n        right: 13px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        cursor: pointer;\n        &:hover{\n        filter: brightness(80%);\n        }\n\n        &:active{\n            filter: none;\n        }\n    }\n"])));function Y(){var e=v().user,n=window.socket,t=Object(r.useState)(""),c=Object(l.a)(t,2),i=c[0],o=c[1],a=Object(r.useState)([]),s=Object(l.a)(a,2),b=s[0],f=s[1];function j(e,n){return new Date(n.createdAt)-new Date(e.createdAt)}function x(){return(x=Object(d.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),o(""),e.next=4,n.request("chatMessage",{message:i});case 4:return e.next=6,null===n||void 0===n?void 0:n.request("listChatMessages");case 6:r=e.sent,f(null===r||void 0===r?void 0:r.sort(j));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n?void 0:n.request("listChatMessages");case 2:t=e.sent,f(null===t||void 0===t?void 0:t.sort(j));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(null===n||void 0===n?void 0:n.connected)&&function(){e.apply(this,arguments)}()}),[n]),Object(r.useEffect)((function(){null===n||void 0===n||n.on("chatMessage",function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f([].concat(Object(L.a)(b),[n.message]).sort(j));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}),[n]),Object(p.jsxs)(D,{children:[Object(p.jsxs)(q,{children:[Object(p.jsxs)("h3",{children:["Chat | ",e.room," "]}),Object(p.jsxs)("p",{children:[Object(p.jsx)(F.c,{size:30})," 20 Pessoas"]})]}),Object(p.jsx)(J,{children:null===b||void 0===b?void 0:b.map((function(e){return Object(p.jsx)(I,{user:e.user.name,message:e.message},e.id)}))}),Object(p.jsxs)(U,{onSubmit:function(e){return x.apply(this,arguments)},children:[Object(p.jsx)("input",{placeholder:"Digite sua mensagem...",value:i,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:Object(p.jsx)(F.d,{size:25})})]})]})}var B,Z,M,V,Q,G,W,K,_=t(206),$=t(207),ee=t(117),ne=new(function(){function e(){Object(_.a)(this,e),this._socket=null,this._mediaDevice=null,this._producer={},this._stream=null}return Object($.a)(e,[{key:"setSocket",value:function(e){this._socket||(this._socket=e)}},{key:"setStream",value:function(e){this._stream||(this._stream=e)}},{key:"loadDevice",value:function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this._mediaDevice=new ee.Device}catch(t){console.log("## 2",t,ee),"UnsupportedError"===t.name&&console.error("browser not supported")}return e.next=3,this._mediaDevice.load({routerRtpCapabilities:n});case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"stopTransmission",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._socket.request("producerTransportClosed");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startTransmission",value:function(){var e=Object(d.a)(u.a.mark((function e(){var n,t,r,c,i,o,a,s,l=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this._socket)||void 0===n?void 0:n.request("getRouterRtpCapabilities");case 2:return t=e.sent,e.next=5,this.loadDevice(t);case 5:return e.next=7,this._socket.request("createProducerTransport",{forceTcp:!1,rtpCapabilities:this._mediaDevice.rtpCapabilities});case 7:if(r=e.sent,(c=this._mediaDevice.createSendTransport(r)).on("connect",function(){var e=Object(d.a)(u.a.mark((function e(n,t,r){var c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.dtlsParameters,e.prev=1,e.next=4,l._socket.request("connectProducerTransport",{dtlsParameters:c});case 4:i=e.sent,t(i),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n,t,r){return e.apply(this,arguments)}}()),c.on("produce",function(){var e=Object(d.a)(u.a.mark((function e(n,t,r){var i,o,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.kind,o=n.rtpParameters,e.prev=1,e.next=4,l._socket.request("produce",{transportId:c.id,kind:i,rtpParameters:o});case 4:a=e.sent,s=a.id,t({id:s}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n,t,r){return e.apply(this,arguments)}}()),c.on("connectionstatechange",function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next="failed"===e.t0?3:5;break;case 3:return c.close(),e.abrupt("break",6);case 5:return e.abrupt("break",6);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),this._stream){e.next=14;break}return e.abrupt("return",console.log("there is no stream provided!"));case 14:return e.prev=14,i=this._stream.getVideoTracks()[0],o=this._stream.getAudioTracks()[0],s={track:o},(a={track:i}).encodings=[{maxBitrate:1e5},{maxBitrate:3e5},{maxBitrate:9e5}],e.next=22,c.produce(a);case 22:return this._producer.video=e.sent,e.next=25,c.produce(s);case 25:this._producer.audio=e.sent,e.next=31;break;case 28:e.prev=28,e.t0=e.catch(14),console.error("stream error",e.t0);case 31:case"end":return e.stop()}}),e,this,[[14,28]])})));return function(){return e.apply(this,arguments)}}()}]),e}()),te=t(210),re=C.b.div(B||(B=Object(N.a)(["\n    width: 100%;\n    overflow: hidden;\n    max-width: 70%;    \n    display: flex;\n    flex-direction: column;\n    padding: 20px;\n    \n    \n    video {\n        border-radius: 15px;\n        width: 100%;\n        max-height: calc(100vh - 200px );\n        object-fit: cover;\n    }\n\n    @media(max-width: 800px){\n        max-width: 100%;    \n    }\n"]))),ce=C.b.div(Z||(Z=Object(N.a)(["\n    margin-top: 20px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n\n"]))),ie=C.b.div(M||(M=Object(N.a)(["\n    display: flex;\n    align-items: center;\n\n    img {\n        height: 60px;\n        margin-right: 10px;\n    }\n"]))),oe=C.b.button(V||(V=Object(N.a)(["\n    background-color: #6b5ecd;\n    height: 60px;\n    border: none;\n    border-radius: 15px;\n    color: #fff;\n    padding: 10px 15px;\n    cursor: pointer;\n    display: flex;\n    justify-content: center;\n    align-items: center;    \n    font-size: 17px;\n\n    svg {\n        margin-right: 5px;\n        margin-bottom: 6px;\n    }\n    \n    &:hover{\n        filter: brightness(80%);\n    }\n\n    &:active{\n        filter: none;\n    }\n\n    &.isLive {\n        background-color: red;\n    }\n\n    &:disabled{\n        background-color: #363342;\n    }\n"]))),ae=t(118),se=t(209),ue=t(208),de=C.b.div(Q||(Q=Object(N.a)(["\n    position: absolute;\n    bottom: 15px;\n    width: 70%;\n    display: flex;\n    justify-content: center;\n    z-index: 10;\n    .device-wrapper {\n        position: relative;\n        margin: 0 10px;\n    }\n\n    .list-devices {\n        position: absolute;\n        border-radius: 50%;\n        border: 1px solid #343a40;\n        height: 20px;\n        width: 20px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        background-color: #fff;\n        padding: 2px;\n        z-index: 5;\n        top: 4px;\n        right: -5px;\n    }\n\n    @media(max-width: 800px){\n        width: 95%;    \n    }\n"]))),le=C.b.div(G||(G=Object(N.a)(["\n    border-radius: 50%;\n    border: 1px solid #343a40;\n    height: 50px;\n    width: 50px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    cursor: pointer;\n    position: relative;\n    background-color: #1f1d2c;\n    &.hangup{\n        background-color: red;\n    }\n"]))),be=C.b.div(W||(W=Object(N.a)(["\n    position: absolute;\n    background-color: #262837;\n    border-radius: 5px;\n    z-index: 5;\n    bottom: 53px;\n    right: -110px;\n    padding: 10px;    \n\n    ul {\n        padding: 0;\n        margin: 0;\n        list-style: none;\n        li {\n            color: #fff;\n            text-align: center;\n            min-width: 250px;\n            cursor: pointer;\n            padding: 2px 10px;\n            margin: 5px 0;\n            font-size: 14px;\n            &.active {\n                border-radius: 5px;\n                padding: 10px;\n                background-color: #1f1d2c;\n            }\n        }\n    }\n"]))),pe=C.b.h6(K||(K=Object(N.a)(["\n    font-weight: bold;\n    text-align: center;\n    color: #fff;\n    margin: 5px 0;\n    margin-bottom: 15px;\n"])));function fe(e){var n=e.deviceList,t=e.deviceType,r=e.handleClose,c=Object(ue.useClickOutside)((function(){return r()}));return Object(p.jsxs)(be,{ref:c,children:[Object(p.jsx)(pe,{children:t}),Object(p.jsx)("ul",{children:null===n||void 0===n?void 0:n.map((function(e,n){return Object(p.jsx)("li",{children:null===e||void 0===e?void 0:e.label},n)}))})]})}var je,xe=function(e){var n=e.micDevicesList,t=e.camDevicesList,c=e.toggleCamera,i=e.toggleMicrofone,o=Object(r.useState)(!0),a=Object(l.a)(o,2),s=a[0],u=a[1],d=Object(r.useState)(!0),b=Object(l.a)(d,2),f=b[0],j=b[1],x=Object(r.useState)(!1),h=Object(l.a)(x,2),m=h[0],g=h[1],O=Object(r.useState)(!1),k=Object(l.a)(O,2),w=k[0],y=k[1],z=v().signOut,A=window.socket;return Object(p.jsxs)(de,{children:[Object(p.jsxs)("div",{className:"device-wrapper",children:[m&&Object(p.jsx)(fe,{handleClose:function(){return g(!m)},deviceList:n,deviceType:"Microfones"}),Object(p.jsx)("button",{className:"list-devices",onClick:function(){return g(!m)},children:m?Object(p.jsx)(F.b,{size:20}):Object(p.jsx)(F.a,{size:20})}),Object(p.jsx)(le,{onClick:function(){s?(u(!1),i(!1)):(u(!0),i(!0))},children:s?Object(p.jsx)(F.e,{size:30}):Object(p.jsx)(F.f,{size:30})})]}),Object(p.jsxs)("div",{className:"device-wrapper",children:[w&&Object(p.jsx)(fe,{handleClose:function(){return y(!w)},deviceList:t,deviceType:"C\xe2meras"}),Object(p.jsx)("button",{className:"list-devices",onClick:function(){return y(!w)},children:w?Object(p.jsx)(F.b,{size:20}):Object(p.jsx)(F.a,{size:20})}),Object(p.jsx)(le,{onClick:function(){f?(j(!1),c(!1)):(j(!0),c(!0))},children:f?Object(p.jsx)(ae.a,{size:30}):Object(p.jsx)(ae.b,{size:30})})]}),Object(p.jsx)("div",{className:"device-wrapper",children:Object(p.jsx)(le,{onClick:function(){A.disconnect(),z(),window.location.reload()},className:"hangup",children:Object(p.jsx)(se.a,{size:25})})})]})};function ve(e){var n=e.videoRef,t=e.audioTracks,r=e.videoTracks,c=e.toggleCamera,i=e.toggleMicrofone,o=e.stream,a=e.toggleIsLive,s=e.isLive,u=v().user;return Object(p.jsxs)(re,{children:[Object(p.jsx)("video",{autoPlay:!0,ref:n,children:"Your browser does not support the video tag."}),Object(p.jsxs)(ce,{children:[Object(p.jsxs)(ie,{children:[Object(p.jsx)("img",{src:R,alt:"Avatar"}),Object(p.jsx)("p",{children:u.name})]}),Object(p.jsxs)(oe,{disabled:!o,className:s?"isLive":"",onClick:function(){return a()},children:[Object(p.jsx)(te.a,{size:30}),s?"Encerrar Live":"Iniciar Live"]})]}),Object(p.jsx)(xe,{toggleCamera:c,toggleMicrofone:i,micDevicesList:t,camDevicesList:r})]})}var he,me,ge,Oe,ke=C.b.div(je||(je=Object(N.a)(["\n    display: flex;\n    justify-content: space-between;\n\n    @media(max-width: 800px){\n        flex-direction: column;\n    }\n"])));function we(){var e=Object(r.useState)([]),n=Object(l.a)(e,2),t=n[0],c=n[1],i=Object(r.useState)([]),o=Object(l.a)(i,2),a=o[0],s=o[1],b=Object(r.useState)(!0),f=Object(l.a)(b,1)[0],j=Object(r.useState)(!0),x=Object(l.a)(j,1)[0],h=Object(r.useState)(),m=Object(l.a)(h,2),g=m[0],O=m[1],w=Object(r.useState)(!1),z=Object(l.a)(w,2),A=z[0],T=z[1],P=v().user,S=window.socket,E=Object(r.useRef)();function H(e){O(e),navigator.mediaDevices.enumerateDevices().then((function(e){s(e.filter((function(e){return"audioinput"===e.kind}))),c(e.filter((function(e){return"videoinput"===e.kind})))})).catch((function(e){console.log(e),alert("Fail to get devices!")}))}return Object(r.useEffect)((function(){P.name&&function(e,n){var t={name:e,room:n},r=y.a.sign(t,"oqksmz");he||((he=k()("https://webrtc.dev.kopa.media/",{auth:{token:r},transport:["websocket","polling"],path:"/v6"})).request=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(t){he.emit(e,n,t)}))},he.on("connect",Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he.request("joinRoom",{roomId:t.room});case 2:case"end":return e.stop()}}),e)})))),window.socket=he)}(P.name,P.room)}),[P.name,P.room]),Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({audio:f,video:x}).then(H).catch((function(e){return console.log(e)}))}),[f,x]),Object(r.useEffect)((function(){navigator.mediaDevices.enumerateDevices().then((function(e){s(e.filter((function(e){return"audioinput"===e.kind}))),c(e.filter((function(e){return"videoinput"===e.kind})))})).catch((function(e){console.log(e),alert("Fail to get devices!")}))}),[]),Object(r.useEffect)((function(){E.current.srcObject=g}),[g]),Object(p.jsxs)(ke,{children:[Object(p.jsx)(ve,{isLive:A,toggleIsLive:function(){return S.connected?g?S.connected&&g&&!A?(ne.setSocket(S),ne.setStream(g),ne.startTransmission(),void T(!0)):(ne.stopTransmission(),void T(!1)):alert("Nenhuma fonte de de m\xeddia dispon\xedvel!"):alert("Socket n\xe3o conectado!")},stream:g,toggleCamera:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=g.getVideoTracks();n[0].enabled=e},toggleMicrofone:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=g.getAudioTracks();n[0].enabled=e},videoRef:E,audioTracks:a,videoTracks:t}),Object(p.jsx)(Y,{})]})}var ye=C.b.div(me||(me=Object(N.a)(["\n    height: 98vh;\n    display: flex;\n    justify-content: center;\n    align-items: center;    \n"]))),ze=C.b.form(ge||(ge=Object(N.a)(["\n    background-color: #222430;\n    max-width: 500px;\n    width: 400px;\n    height: 500px;\n    border-radius: 15px;\n    display: flex;\n    flex-direction: column;\n    padding: 30px;\n    justify-content: space-between;\n    \n    label {\n        color: #7e8291;    \n        margin-left: 10px;    \n    }\n\n    input {\n        width: 100%;\n        background-color: #2e303f;\n        border: none;\n        color: #fff;\n        outline: none;\n        border-radius: 20px;\n        padding: 10px;\n        height: 45px;\n        margin: 5px 0 20px 0;\n    }\n\n    button {\n        background-color: #6b5ecd;\n        height: 60px;\n        border: none;\n        border-radius: 15px;\n        color: #fff;\n        padding: 10px 15px;\n        cursor: pointer;\n        display: flex;\n        justify-content: center;\n        align-items: center;    \n        font-size: 17px;\n\n        svg {\n            margin-right: 5px;\n            margin-bottom: 6px;\n        }\n        \n        &:hover{\n            filter: brightness(80%);\n        }\n\n        &:active{\n            filter: none;\n        }\n    }\n"]))),Ae=C.b.h2(Oe||(Oe=Object(N.a)(["\n    text-align: center;\n"])));function Te(){var e=v().signIn,n=Object(r.useState)(""),t=Object(l.a)(n,2),c=t[0],i=t[1],o=Object(r.useState)(""),a=Object(l.a)(o,2),s=a[0],u=a[1];return Object(p.jsx)(ye,{children:Object(p.jsxs)(ze,{onSubmit:function(n){if(n.preventDefault(),!c||!s)return alert("O seu nome e a sala devem ser informados!");e({name:c,room:s})},children:[Object(p.jsx)(Ae,{children:"Entrar"}),Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{htmlFor:"name",children:"Nome"}),Object(p.jsx)("input",{value:c,id:"name",type:"text",placeholder:"Informe seu nome",onChange:function(e){return i(e.target.value)}}),Object(p.jsx)("label",{htmlFor:"room",children:"Sala"}),Object(p.jsx)("input",{value:s,id:"room",type:"text",placeholder:"informe o nome da sala",onChange:function(e){return u(e.target.value)}})]}),Object(p.jsx)("button",{type:"submit",children:"ENTRAR"})]})})}var Pe,Se=t(212);function Ee(e){var n=e.component,t=Object(Se.a)(e,["component"]),r=v().signed;return Object(p.jsx)(b.b,Object(m.a)(Object(m.a)({},t),{},{render:function(e){return r?Object(p.jsx)(n,Object(m.a)({},e)):Object(p.jsx)(b.a,{to:{pathname:"/signin",state:{from:e.location}}})}}))}function He(){return Object(p.jsxs)(b.d,{children:[Object(p.jsx)(Ee,{path:"/",component:we,exact:!0}),Object(p.jsx)(b.b,{path:"/signin",component:Te})]})}var Le=Object(C.a)(Pe||(Pe=Object(N.a)(["\n    html {\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    -ms-overflow-style: scrollbar;\n    }\n\n    *,\n    *::before,\n    *::after {\n    -webkit-box-sizing: inherit;\n            box-sizing: inherit;\n    }\n    \n    body{\n      font-family: sans-serif;\n      background-color: #1f1d2c;\n      color: #fff;\n    }\n"])));var Fe=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(Le,{}),Object(p.jsx)(a.a,{children:Object(p.jsx)(g,{components:[x,A],children:Object(p.jsx)(He,{})})})]})},Ne=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,388)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),r(e),c(e),i(e),o(e)}))};o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(Fe,{})}),document.getElementById("root")),Ne()}},[[387,1,2]]]);
//# sourceMappingURL=main.461cf64a.chunk.js.map